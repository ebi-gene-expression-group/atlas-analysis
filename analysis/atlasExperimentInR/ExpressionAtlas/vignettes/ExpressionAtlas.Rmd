---
title: "ExpressionAtlas package vignette"
author: "Maria Keays"
date: "`r Sys.Date()`"
vignette: >
    %\VignetteEngine{ knitr::rmarkdown }
    %\VignetteIndexEntry{ ExpressionAtlas }
---

# Expression Atlas

The EMBL-EBI [Expression Atlas](http://www.ebi.ac.uk/gxa) consists of
high-throughput expression datasets that are re-processed to allow users to
search for genes with interesting expression patterns under different
biological conditions, such as a gene knock out, a compound treatment, or in a
particular organism part or cell. Data fron each experiment in Expression
Atlas is available as a pre-packaged experiment summary R object available for
download. The *ExpressionAtlas* package enables these files to be loaded
directly within an R session.

# Downloading Expression Atlas data in R

To download Expression Atlas datasets, you need to know their
[ArrayExpress](http://www.ebi.ac.uk/arrayexpress) accession numbers. These can
be found by searching at the Expression Atlas website and clicking on any of
the results that appear. The URL of the Expression Atlas experiment page
contains the experiment accession e.g. in
http://www.ebi.ac.uk/gxa/experiments/E-MTAB-3007 , the accession is
**E-MTAB-3007**.

## Downloading a single Expression Atlas experiment summary

You can download data for a single Expression Atlas experiment using the
`getAtlasExperiment() function:

```{r}
library( ExpressionAtlas )
library( SummarizedExperiment )

mtab3007 <- getAtlasExperiment( "E-MTAB-3007" )
```

Data is returned as a *SimpleList* object (see package
[S4Vectors](http://bioconductor.org/packages/release/bioc/html/S4Vectors.html)).

## RNA-seq experiment summaries

Following on from above, `mtab3007` now contains a *SimpleList* object 
with a single entry named `rnaseq`. For RNA-seq experiments, the entry is a
*RangedSummarizedExperiment* objects (see package
[SummarizedExperiment](http://bioconductor.org/packages/release/bioc/html/SummarizedExperiment.html)).

```{r}
sumexp <- mtab3007$rnaseq
sumexp
```

The matrix of raw counts for this experiment is stored in the *assays* slot:

```{r}
head( assays( sumexp ) )
```

The sample annotations can be found in the *coldata* slot:

```{r}
colData( sumexp )
```

Information describing how the raw data files were processed to obtain the raw
counts matrix are found in the *metadata* slot:

```{r eval=FALSE}
metadata( sumexp )
```

## Single-channel microarray experiments.

Data from a single-channel microarray experiment, e.g.
[E-GEOD-16567](http://www.ebi.ac.uk/gxa/experiments/E-GEOD-16567), is
represented as one or more [ExpressionSet]() objects in the SimpleList that is
downloaded. ExpressionSet objects are indexed by the ArrayExpress accession(s)
of the microarray(s) used in the original experiment.

```{r}
geod16567 <- getAtlasExperiment( "E-GEOD-16567" )
names( geod16567 )
affy77data <- geod16567[[ "A-AFFY-77" ]]
affy77data
```

The matrix of normalized intensity values is in the *assayData* slot:

```{r}
exprs( affy77data )
```

The sample annotations are in the *phenoData* slot:

```{r}
pData( affy77data )
```

A brief outline of how the raw data was normalized is in the *experimentData* slot:

```{r}
preproc( experimentData( affy77data ) )
```
